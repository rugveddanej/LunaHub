-- local variables

local player = game.Players.LocalPlayer
local player_name = player.Name
local player_data = nil
local player_value = nil
local webhook = ""
local vfx = game:GetService("ReplicatedStorage").Assets.Particles:FindFirstChild("Parts")
local ts = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local tpservice = game:GetService("TeleportService")

-- small start script

for i, v in pairs(game:GetService("ReplicatedStorage").Player_Data:GetChildren()) do
    if v.Name == player_name then
        player_data = v
    end
end

for i, v in pairs(game:GetService("ReplicatedStorage").PlayerValues:GetChildren()) do
    if v.Name == player_name then
        player_value = v
    end
end
-- tables

local bosses = {"Zanegutsu Kuuchie", "Sabito", "Giyu", "Slasher", "Nezuko", "Shiron", "Susamaru", "Yahaba", "Sanemi"}
local serverboss = {}
local bossCFrame = {
    ["Shiron"] = CFrame.new(3193, 370, -3932),
    ["Susamaru"] = CFrame.new(1318, 315, -4566),
    ["Yahaba"] = CFrame.new(1262, 318, -4616),
    ["Giyu"] = CFrame.new(3014, 375, -2910),
    ["Zanegutsu Kuuchie"] = CFrame.new(-333, 425, -2268),
    ["Sanemi"] = CFrame.new(1612, 348, -3692),
    ["Nezuko"] = CFrame.new(3611, 341, -4536),
    ["Sabito"] = CFrame.new(1217, 275, -2790),
    ["Slasher"] = CFrame.new(4367, 341, -4366)
}

local wbhookrar = {
    "Rare"
}

local selectedorbs = {}

-- toggle status

local godmode = false
local godmodemethod = nil
local tweenspeed = 300
local infinitestamina = true
local killaura = false
local akeza_invible = false
local method = "fist_combat"
local allbossfarm = false
local collectchest = false
local thunderka = false
local webhooktog = false
local autoorb = false
local alwaysday = false

-- remotes args
local killaurargs1 = {
    [1] = "fist_combat",
    [2] = game:GetService("Players").LocalPlayer,
    [3] = game:GetService("Players").LocalPlayer.Character,
    [4] = game:GetService("Players").LocalPlayer.Character.HumanoidRootPart,
    [5] = game:GetService("Players").LocalPlayer.Character.Humanoid,
    [6] = 919,
    [7] = "ground_slash"
}

local killaurargs2 = {
    [1] = "fist_combat",
    [2] = game:GetService("Players").LocalPlayer,
    [3] = game:GetService("Players").LocalPlayer.Character,
    [4] = game:GetService("Players").LocalPlayer.Character.HumanoidRootPart,
    [5] = game:GetService("Players").LocalPlayer.Character.Humanoid,
    [6] = math.huge,
    [7] = "ground_slash"
}

local godmodeargs = {
    [1] = "skil_ting_asd",
    [2] = game:GetService("Players").LocalPlayer,
    [3] = nil,
    [4] = 1
}

-- functions

function charexist()
    task.spawn(function()
        if player_char then
            return true
        end
    end)
end

function noclip()
    for i, v in pairs(game.Players.LocalPlayer.Character:GetDescendants()) do
        if v:IsA("BasePart") and v.CanCollide == true then
            v.CanCollide = false
        end
    end
end

function tpto(p1)
    task.spawn(function()
        pcall(function()
            player.Character.HumanoidRootPart.CFrame = p1
        end)
    end)
end

function checkdistance(obj)
    task.spawn(function()
        return (obj.Position - game.Players.LocalPlayer.HumanoidRootPart.Position).Magnitude
    end)
end

function tweento(obj)
    local Distance = (obj.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
    local Speed = Distance/tweenspeed

    local tween = ts:Create(game.Players.LocalPlayer.Character.HumanoidRootPart,
        TweenInfo.new(Speed, Enum.EasingStyle.Linear),
        { CFrame = obj}
    )

    tween:Play()

    return tween
end

function findMob(hrp)
    for i, v in pairs(workspace.Mobs:GetDescendants()) do
        if v:IsA("Model") and v:FindFirstChild("Humanoid") and v:FindFirstChild("Humanoid").Health > 0 then
            if hrp then
                if v:FindFirstChild('HumanoidRootPart') then
                    return v
                end
            else
                return v
            end
        end
    end
end

function findPlayer(hrp)
    for i, target in pairs(game.Players:GetPlayers()) do
        if target ~= player and target.Character:FindFirstChild("HumanoidRootPart") then
            return target.Character
        end
    end
end

function closestMob()
    local closestMob
    local closestDistance = math.huge
    for _, mob in ipairs(workspace.Mobs:GetDescendants()) do
        if mob:IsA("Model") and mob:FindFirstChild("HumanoidRootPart") and mob.Humanoid.Health > 0 then
            local distance = (mob.HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
            if distance < closestDistance then
                closestMob = mob
                closestDistance = distance
            end
        end
    end
    return closestMob
end

function webhookf(message)
        task.spawn(function()
            request({
            Url = webhook,
            Method = "POST",
            Headers = {
                ["Content-Type"] = "application/json"
            },
            Body = game.HttpService:JSONEncode({
                content = message
           })
        })
    end)
end

function findBoss(name, hrp)
    for i, v in pairs(workspace.Mobs:GetDescendants()) do
        if v:IsA("Model") and v.Name == name and v:FindFirstChild("Humanoid") then
            if hrp then
                if v:FindFirstChild('HumanoidRootPart') then
                    return v
                end
            else
                return v
            end
        end
    end
end

-- upd function

function updweapon(weapon)
    task.spawn(function()
        if weapon == "Combat" then
            method = "fist_combat"
        elseif weapon == "Scythe" then
            method = "Scythe_Combat_Slash"
        elseif weapon == "Sword" then
            method = "Sword_Combat_Slash"
        elseif weapon == "War Fans" then
            method = "fans_combat_slash"
        elseif weapon == "Claws" then
            method = "claw_Combat_Slash"
        end
        killaurargs1[1] = method
        killaurargs2[2] = method
    end)
end

function updgodmode(godmodem)
    task.spawn(function()
        if godmodem == "Scythe -- Mas 28 + Equipped" then
            godmodemethod = "scythe_asteroid_reap"
        elseif godmodem == "Water Breathing -- Mas 1" then
            godmodemethod = "Water_Surface_Slash"
        elseif godmodem == "Insect Breating -- Mas 28" then
            godmodemethod = "insect_breathing_dance_of_the_centipede"
        elseif godmodem == "Blood Burst Bda -- Mas 20" then
            godmodemethod = "blood_burst_explosive_choke_slam"
        elseif godmodem == "Wind Breathing -- Mas 30" then
            godmodemethod = "Wind_breathing_black_wind_mountain_mist"
        elseif godmodem == "Snow Breathing -- Mas 1" then
            godmodemethod = "snow_breatihng_layers_frost"
        elseif godmodem == "Flame Breathing -- Mas 32" then
            godmodemethod = "flame_breathing_flaming_eruption"
        elseif godmodem == "Beast Breathing -- Mas 40" then
            godmodemethod = "Beast_breathing_devouring_slash"
        elseif godmodem == "Shockwave Bda -- Mas 44" then
            godmodemethod = "akaza_flashing_williow_skillasd"
        elseif godmodem == "Dream Bda -- Ult Unlocked" then
            godmodemethod = "dream_bda_flesh_monster"
        elseif godmodem == "Swamp Bda -- Ult Unlocked" then
            godmodemethod = "swamp_bda_swamp_domain"
        elseif godmodem == "Sound Breathing -- Mas 50" then
            godmodemethod = "sound_breathing_smoke_screen"
        elseif godmodem == "Ice Bda -- Ult Unlocked" then
            godmodemethod = "ice_demon_art_bodhisatva"
        end
        godmodeargs[3] = godmodemethod
    end)
end

function updfarmpos(method)
    task.spawn(function()
        if method == "Above" then
            ydistancefromboss = distancefromboss
            zdistancefromboss = 0
        elseif method == "Below" then
            ydistancefromboss = -distancefromboss
            zdistancefromboss = 0
        elseif method == "Behind" then
            ydistancefromboss = 0
            zdistancefromboss = distancefromboss
        end
    end)
end
-- const running functions


task.spawn(function()
    while task.wait(0.3) do
        if godmode then
            local args = {
                [1] = "skil_ting_asd",
                [2] = player,
                [3] = godmodemethod,
                [4] = 1
            }
            
            game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S:FireServer(unpack(args))                                         
        end
    end
end)

task.spawn(function()
    while task.wait() do
        if killaura then
            for i = 1, 8 do
                game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S:FireServer(unpack(killaurargs1))
                game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S:FireServer(unpack(killaurargs2))
            end
            task.wait(1)
            repeat task.wait()
            until player.combotangasd123.Value == 0
        end
    end
end)


task.spawn(function()
    while task.wait() do
        if collectchest then
            repeat task.wait()
                if collectchest then
                    pcall(function()
                        for a, b in pairs(game.Workspace.Debree:GetChildren()) do
                            if b.Name == "Loot_Chest" then
                                for c, d in pairs(b.Drops:GetChildren()) do
                                    b.Add_To_Inventory:InvokeServer(d.Name)
                                    if webhooktog and not table.find(wbhookrar, d.Value) then
                                        webhookf("||"..player.Name.."|| collected a "..d.Name.. ", rarity ".. d.Value)
                                    end
                                end
                                b:Destroy()
                            end
                        end 
                    end)
                end
            until not collectchest
        end
    end
end)

local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()

local Window = OrionLib:MakeWindow({Name = "Luna Hub", HidePremium = false, SaveConfig = false, ConfigFolder = "LunaHub ", IntroText = "Luna Hub"})

local grind = Window:MakeTab({
    Name = "Grind",
    Icon = "rbxassetid://18717869990",
    PremiumOnly = false
})

local killauratab = Window:MakeTab({
    Name = "Kill Auras",
    Icon = "rbxassetid://18717931050",
    PremiumOnly = false
})

local misctab = Window:MakeTab({
    Name = "Misc",
    Icon = "rbxassetid://18718007636",
    PremiumOnly = false
})

local buffstab = Window:MakeTab({
    Name = "Buffs",
    Icon = "rbxassetid://18717962804",
    PremiumOnly = false
})

-- Create the Settings tab
local settingstab = Window:MakeTab({
    Name = "Settings",
    Icon = "rbxassetid://18718015946",
    PremiumOnly = false
})

local gui = settingstab:AddSection({
    Name = "GUI"
})

-- Add the Unload GUI button
gui:AddButton({
    Name = "Unload Gui",
    Callback = function()
        OrionLib:Destroy()
    end
})


-- farming tab
local grindsettings = grind:AddSection({
	Name = "Grind Settings"
})

grindsettings:AddDropdown({
	Name = "Weapon Selection",
	Default = "Combat",
	Options = {"Combat", "Scythe", "Sword", "War Fans", "Claws"},
	Callback = function(Value)
		updweapon(Value)
	end    
})


grindsettings:AddSlider({
	Name = "Tween Speed",
	Min = 100,
	Max = 500,
	Default = 300,
	Color = Color3.fromRGB(255,255,255),
	Increment = 1,
	ValueName = "TweenSpeed",
	Callback = function(Value)
		tweenspeed = Value
	end    
})


local autogrind = grind:AddSection({
	Name = "Grind"
})

autogrind:AddToggle({
	Name = "Tween to Bosses",
	Default = false,
	Callback = function(state)
		allbossfarm = state
        task.spawn(function()
            while allbossfarm do
                noclip()
                task.wait(1)
            end
        end)
        task.spawn(function()
            local antifall = Instance.new("BodyVelocity")
            antifall.Velocity = Vector3.new(0, 0, 0)
            antifall.Parent = player.Character.HumanoidRootPart
            while allbossfarm do
                for _, boss in pairs(bosses) do
                    if allbossfarm then
                        local cframe = bossCFrame[boss]
                        local tween = tweento(cframe)
                        tween.Completed:Wait()
                        local boboss = findBoss(boss, true)
                        if boboss ~= nil  and allbossfarm then
                            while boboss:FindFirstChild("Humanoid").Health > 0 and allbossfarm do
                                pcall(function()
                                    tpto(boboss.HumanoidRootPart.CFrame * CFrame.new(0, 0, 10))
                                end)
                                task.wait()
                            end
                        end
                    end
                end
                task.wait()
            end
            antifall:Destroy()
        end)
	end    
})




autogrind:AddToggle({
    Name = 'Kill Aura',
    Default = false,

    Callback = function(Value)
        if Value then
            killaura = true
        else
            killaura = false
        end
    end
})

autogrind:AddToggle({
    Name = 'Auto Collect Chests',
    Default = false,

    Callback = function(Value)
        if Value then
            collectchest = true
        else
            collectchest = false
        end
    end
})


-- KA TAB

local arrowkag = killauratab:AddSection({
	Name = "Arrow Kill Aura"
})

local ArrowKA = false
local BringMobs = false
local BreakBossesArrow = false
local PlayerKA = false

arrowkag:AddToggle({
    Name = 'Arrow Kill Aura',
    Default = false,
    Callback = function(state)
        ArrowKA = state
        task.spawn(function()
            while ArrowKA do 
                local target = findMob(true)
                if target then
                    local args = {
                        [1] = "arrow_knock_back_damage",
                        [2] = player.Character,
                        [3] = target:GetModelCFrame(),
                        [4] = target,
                        [5] = math.huge,
                        [6] = math.huge
                    }

                    game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S_:InvokeServer(unpack(args))
                end
                task.wait()
            end
        end)
        task.spawn(function()
            while ArrowKA do
                local args = {
                    [1] = "skil_ting_asd",
                    [2] = player,
                    [3] = "arrow_knock_back",
                    [4] = 5
                }

                game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S_:InvokeServer(unpack(args))
                task.wait(6)
            end
        end)
    end
})

arrowkag:AddToggle({
    Name = 'Pull Mobs',
    Default = false,
    Callback = function(state)
    BringMobs = state
    task.spawn(function()
        while BringMobs do 
            local target = findMob(true)
            if target then
                repeat task.wait()
                    local args = {
                        [1] = "piercing_arrow_damage",
                        [2] = player,
                        [3] = target:GetModelCFrame(),
                        [4] = math.huge
                    }
                    game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S_:InvokeServer(unpack(args))
                until target.Humanoid.Health <= 0 or not BringMobs
            end
            task.wait()
        end
    end)
    task.spawn(function()
        while BringMobs do
            local args = {
                [1] = "skil_ting_asd",
                [2] = player,
                [3] = "arrow_knock_back",
                [4] = 5
            }
            game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S_:InvokeServer(unpack(args))
            task.wait(6)
        end
    end)
end})

arrowkag:AddToggle({
    Name = 'Player Kill Aura',
    Default = false,
    Callback = function(state)
        PlayerKA = state
        task.spawn(function()
            while PlayerKA do 
                local target = findPlayer(true)
                if target then
                    local args = {
                        [1] = "arrow_knock_back_damage",
                        [2] = player.Character,
                        [3] = target:GetModelCFrame(),
                        [4] = target,
                        [5] = math.huge,
                        [6] = math.huge
                    }
                    game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S_:InvokeServer(unpack(args))
                end
                task.wait(0.01)
            end
        end)
        task.spawn(function()
            while PlayerKA do
                local args = {
                    [1] = "skil_ting_asd",
                    [2] = player,
                    [3] = "arrow_knock_back",
                    [4] = 5
                }

                game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S_:InvokeServer(unpack(args))
                task.wait(6)
            end
        end)
    end
})


arrowkag:AddButton({
    Name = 'Break Bosses',
    Callback = function()
        BreakBossesArrow = true
        task.spawn(function()
            if BreakBossesArrow then
                for _, mob in pairs(game:GetService("ReplicatedStorage").Npcs:GetChildren()) do
                    if table.find(serverboss, mob.Name) then
                        repeat task.wait()
                            local args = {
                                [1] = "arrow_knock_back_damage",
                                [2] = player.Character,
                                [3] = mob:GetModelCFrame(),
                                [4] = mob,
                                [5] = 300,
                                [6] = 300
                            }

                            game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S_:InvokeServer(unpack(args))
                            task.wait(0.1)
                        until mob.Humanoid.Health <= 0
                    end
                end
                BreakBossesArrow = false
            end
        end)
        task.spawn(function()
            while breakserver do
                local args = {
                    [1] = "skil_ting_asd",
                    [2] = player,
                    [3] = "arrow_knock_back",
                    [4] = 5
                }

                game:GetService("ReplicatedStorage").Remotes.To_Server.Handle_Initiate_S_:InvokeServer(unpack(args))
                task.wait(6)
            end
        end)
    end
})

--misc tab

local miscs = misctab:AddSection({
	Name = "Misc"
})
miscs:AddToggle({
    Name = 'Remove Particles',
    Default = false,
    Callback = function(state)
        if state then
            vfx.Parent = nil
        else
            vfx.Parent = game:GetService("ReplicatedStorage").Assets.Particles
        end
    end
})

miscs:AddButton({
    Name = 'Delete map',
    Callback = function()
        workspace.Map:Destroy()
        workspace.Terrain.Water_Regions:Destroy()
    end
})


miscs:AddToggle({
    Name = 'Always Day',
    Default = false,
    Callback = function(state)
        alwaysday = state
        if state then 
            task.spawn(function()
                while alwaysday do
                    workspace.DayNNight.Value = 10
                    task.wait()
                end
            end)
        end
    end
})

local teleportgb = misctab:AddSection({
	Name = "Teleport"
})

teleportgb:AddButton({
    Name = 'Rejoin',
    Callback = function()
        tpservice:TeleportToPlaceInstance(game.PlaceId, game.JobId, game.Players.LocalPlayer)
    end,

})
-- BUFF TAB

local buffgb = buffstab:AddSection({
	Name = "Buffs"
})


buffgb:AddButton({
    Name = "ThunderMode [Human]",
    Callback = function()
        game:GetService("ReplicatedStorage").Remotes.thundertang123:FireServer(true)
    end
})
buffgb:AddButton({
    Name = "Rengoku Mode [Human]",
    Callback = function()
        game:GetService("ReplicatedStorage").Remotes.heart_ablaze_mode_remote:FireServer(true)
    end
})
buffgb:AddButton({
    Name = "God Kamado [Kamado Clan]",
    Callback = function()
        game:GetService("ReplicatedStorage").Remotes.heal_tang123asd:FireServer(true)
    end
})
buffgb:AddButton({
    Name = "WarDrums [Demon]",
    Callback = function()
        while true do
            game:GetService("ReplicatedStorage").Remotes.war_Drums_remote:FireServer(true)
            task.wait(20)
        end
    end
})
buffgb:AddButton({
    Name = "Health Regeneration [Any Breathing]",
    Callback = function()
        game:GetService("ReplicatedStorage").Remotes.regeneration_breathing_remote:FireServer(true)
    end
})
buffgb:AddButton({
    Name = "Sun Immunity [Demon]",
    Callback = function()
        game:GetService("Players").LocalPlayer.PlayerScripts.Small_Scripts.Gameplay.Sun_Damage.Disabled = true
    end
})
buffgb:AddButton({
    Name = "Furiosity",
    Callback = function()
        while true do
            game:GetService("ReplicatedStorage").Remotes.clan_furiosity_add:FireServer(true)
            task.wait(24)
        end
    end
})
buffgb:AddButton({
    Name = "Spacial Awareness",
    Callback = function()
        game:GetService("ReplicatedStorage").Remotes.spacial_awareness_remote:FireServer(true)
    end
})
